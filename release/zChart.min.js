window.zChart=window.zChart||{},function(a){var b=.618,c={calculateFontSize:function(a){if(a&&""!==a)for(var b=a.split(" "),c=0;c<b.length;c++)if(b[c].indexOf("px")>0)return parseInt(b[c].substr(0,b[c].length-2));return 0},findMax:function(a,b,c){var d=this.getFields(b,"yField");return this.findMaxInAll(a,d,c)},findMaxInAll:function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(this.max(a,b[e],c));return this.max(d,void 0,c)},max:function(a,b,c){var d=null;if(a&&a.length>0){d=void 0===b?a[0]:a[0][b];for(var e=1;e<a.length;e++){var f=void 0===b?a[e]:a[e][b];void 0!==c&&c===!0?d>f&&(d=f):f>d&&(d=f)}}return d},getFields:function(a,b){var c=[];if(a&&a.length>0)for(var d=0;d<a.length;d++)c.push(a[d][b]);return c},getScale:function(a){var b=this.floor(a);return b>0?b.toString().length:0},getScales:function(a){var c,d=[0],e=10,f=this.getScale(a);if(1>=f){c=a>5?1:.5;for(var g=1;e>=g;g++)d.push(c*g)}else if(a>Math.pow(10,f)*b){c=Math.pow(10,f-1);for(var h=1;e>=h;h++)d.push(c*h)}else{c=Math.pow(10,f-1)/2;for(var i=a/c,j=1;i+2>=j;j++)d.push(c*j)}return d},calculateXAxisItemWidth:function(a,b,c){var d=0,e=300,f=e;return a>0&&(f=c/a/(b+1)),d=f>1?e>=f?this.floor(f):e:1},floor:function(a){var b=a.toString().split(".");return parseInt(b[0])},mouseIn:function(a,b,c,d,e,f){return a>c&&c+e>a&&b>d&&d+f>b?!0:!1},mouseInCircle:function(a,b,c,d,e){var f=Math.abs(a-c),g=Math.abs(b-d),h=Math.sqrt(f*f+g*g);return e>h}};a.Utils=c}(window.zChart),window.zChart=window.zChart||{},function(a){var b=5,c=23,d=13,e=100,f=6*b,g="14px Segoe UI Light",h="12px Segoe UI Light",i=30,j=10,k="10px Segoe UI Light",l=5,m=function(a,b){this.canvas=a,this.context=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this._parameters=b},n=m.prototype;n.initialize=function(){var a=["dataProvider","series"],c={animated:!0,showTooltip:!0,showLegend:!0,showGrid:!0,title:{label:"",color:"#000",font:g,top:b}};if(void 0===this._parameters||null===this._parameters)return console.error("Error: miss param "),!1;for(var d=0;d<a.length;d++)if(!this._parameters.hasOwnProperty(a[d]))return console.error("Error: miss param "+a[d]),!1;for(var h in c)if(this[h]=void 0===this._parameters[h]?c[h]:this._parameters[h],"title"==h)for(var i in c.title)this.title[i]=void 0===this.title[i]?c.title[i]:this.title[i];return this.width<e||this.height<f?(console.error("Canvas is too small for zChart(minWidth:"+e+", minHeight:"+f),!1):(this._headerHeight=0,this._footerHeight=2*b,this._paddingRight=2*b,this._paddingBottom=2*b,!0)},n.drawChart=function(){this.initialize()&&(this.drawTitle(),this.drawLegend(),this.createTooltip(),this.draw())},n.drawTitle=function(){if(""!==this.title.label){var c=this.title.top;this.drawLabel(this.width/2,c,this.title.label,"center",this.title.font),this._headerHeight=c+a.Utils.calculateFontSize(this.context.font)/2+b}},n.drawLegend=function(){var a=0,c=this.width/2,d=this.height-j-this._paddingBottom,e=this.getSeries();if(this.showLegend){this.setFooterHeight(j+2*this._paddingBottom);for(var f=0;f<e.length;f++){var g=e[f],h=g.label?g.label:g.yField;c+=a,a=i+2*b+this.calculateLabelWidth(h),this.drawRect(c,d,i,j,g.fillColor,g.strokeColor),this.drawLabel(c+i+b,d+j,h,"left")}}},n.setParameter=function(a){this._parameters=a},n.reload=function(){this.clearRect(0,0,this.width,this.height),this.drawChart()},n.clearRect=function(a,b,c,d){this.context.clearRect(a,b,c,d)},n.draw=function(){console.error("BaseChart should not be initialized directly. Use sub classes(BarChart, LineChart etc) instead.")},n.createTooltip=function(){void 0===this._tipCanvas&&(this._tipCanvas=document.createElement("canvas"),this._tipCanvas.width=100,this._tipCanvas.height=c,this._tipCanvas.style.position="absolute",this.canvas.nextSibling?this.canvas.parentNode.insertBefore(this._tipCanvas,this.canvas.nextSibling):this.canvas.parentNode.appendChild(this._tipCanvas))},n.getTooltip=function(){return this._tipCanvas},n.hideTooltip=function(){this._tipCanvas.style.left="-"+(this._tipCanvas.width+2e3)+"px"},n.customizeTooltip=function(a,b,c,d,e){var f=0,g=0,h=6,i=e-h;a.clearRect(f,g,d,i),a.beginPath(),a.moveTo(f+l,g),a.lineTo(f+d-l,g),a.quadraticCurveTo(f+d,g,f+d,g+l),a.lineTo(f+d,g+i-l),a.quadraticCurveTo(f+d,g+i,f+d-l,g+i),a.lineTo(f+d/2+h/2,g+i),a.lineTo(f+d/2,g+e),a.lineTo(f+d/2-h/2,g+i),a.lineTo(f+l,g+i),a.quadraticCurveTo(f,g+i,f,g+i-l),a.lineTo(f,g+l),a.quadraticCurveTo(f,g,f+l,g),a.closePath(),a.strokeStyle="black",a.stroke(),a.fillStyle="rgba(0, 0, 0, 0.7)",a.fill(),a.font=k,a.fillStyle="white",a.textAlign="left";for(var j=0;j<c.length;j++){var m=c[j].yField,n=void 0===c[j].label?m:c[j].label;a.fillText(this.tooltipLabelFunc(n,b[m],this.getYAxisLabelFunc()),2,this.getTooltipDefaultLineHeight()*(j+1))}},n.getMaxLabelWidth=function(b,c){for(var d=[],e=0;e<c.length;e++)d.push({width:this.calculateLabelWidth(this.tooltipLabelFunc(c[e].label,b,this.getYAxisLabelFunc()),k)});return a.Utils.max(d,"width")},n.tooltipLabelFunc=function(a,b,c){return c&&(b=c.call(null,b)),a+":"+b},n.getParam=function(){return this._parameters},n.getData=function(){return this._parameters.dataProvider},n.getSeries=function(){return this._parameters.series},n.getDefaultPadding=function(){return b},n.getPaddingRight=function(){return this._paddingRight},n.setHeaderHeight=function(a){this._headerHeight=a},n.getHeaderHeight=function(){return this._headerHeight},n.setFooterHeight=function(a){this._footerHeight=a},n.getFooterHeight=function(){return this._footerHeight},n.getTooltipDefaultHeight=function(){return c},n.getTooltipDefaultLineHeight=function(){return d},n.getTooltipFont=function(){return k},n.calculateLabelWidth=function(a,b){return this.context.font=void 0===b?h:b,this.context.measureText(a).width},n.drawLabel=function(a,b,c,d,e){this.context.font=void 0===e?h:e,this.context.textAlign=d,this.context.fillStyle="black",this.context.fillText(c,a,b)},n.drawRect=function(a,b,c,d,e,f){this.context.beginPath(),this.context.rect(a,b,c,d),this.context.fillStyle=e?e:"#0099ff",e&&this.context.fill(),this.context.lineWidth=1,this.context.strokeStyle=f,this.context.stroke()},n.drawLines=function(a,b,c,d,e){this.context.strokeStyle=e,this.context.lineWidth=d,this.context.beginPath(),this.context.moveTo(a,b);for(var f=0;f<c.length;f++)this.context.lineTo(c[f].x,c[f].y);this.context.stroke()},n.mouseIn=function(b,c,d,e,f,g){return a.Utils.mouseIn(b,c,d,e,f,g)},a.BaseChart=m}(window.zChart),function(a){var b=6,c="gray",d=function(b,c){a.BaseChart.call(this,b,c),this._yLabelWidth=40,this._yLabelHeight=20},e=d.prototype=Object.create(a.BaseChart.prototype);e.draw=function(){this.drawAxes(),this.drawDataArea()},e.drawAxes=function(){this._origin={x:this.getDefaultPadding()+this._yLabelWidth,y:this.height-this.getFooterHeight()-this._yLabelHeight},this.setXAxisLength(this.width-this.getPaddingRight()-this._origin.x),this.setYAxisLength(this._origin.y-this.getHeaderHeight());var a=this.getDefaultPadding(),d=this._origin.x,e=this.getHeaderHeight(),f=this.getScales(),g=this.getXAxisLength(),h=this.getYAxisLength(),i=d+g,j=[];j.push({x:d,y:this._origin.y}),j.push({x:i,y:this._origin.y}),this.showGrid&&(j.push({x:i,y:e}),j.push({x:d,y:e})),this.drawLines(d,e,j,"1",c);var k=this.getYAxisLabelFunc();if(f.length>1)for(var l=h/(f.length-1),m=0;m<f.length;m++){var n=this._origin.y-l*m,o=void 0===k?f[m]:k.call(null,f[m]),p=m%2===0?"2":"1",q=[],r=this.calculateLabelWidth(o);q.push({x:this._origin.x-b,y:n}),this.showGrid&&q.push({x:i,y:n}),this.drawLines(this._origin.x,n,q,p,"#e5e5e5"),this.drawLabel(a+(this._yLabelWidth-(r+b)),n+4,o,"left")}},e.drawDataArea=function(){console.error("AxesChart should not be initialized directly. Use sub classes(BarChart, LineChart etc) instead.")},e.getOriginPoint=function(){return this._origin},e.setXAxisLength=function(a){this.xAxisLength=a},e.getXAxisLength=function(){return this.xAxisLength},e.setYAxisLength=function(a){this.yAxisLength=a},e.getYAxisLength=function(){return this.yAxisLength},e.getMax=function(){return a.Utils.findMax(this.getData(),this.getSeries())},e.getScales=function(){return a.Utils.getScales(this.getMax())},e.getMaxScale=function(){var a=1,b=this.getScales();return b.length>0&&(a=b[b.length-1]),a},e.getXFields=function(){return a.Utils.getFields(this.getSeries(),"xField")},e.getYFields=function(){return a.Utils.getFields(this.getSeries(),"yField")},e.getYAxisLabelFunc=function(){var a=this.getParam();return void 0===a.yAxis?void 0:a.yAxis.labelFunction},a.AxesChart=d}(window.zChart),function(a){var b=function(b,c){a.AxesChart.call(this,b,c)},c=b.prototype=Object.create(a.AxesChart.prototype);c.drawDataArea=function(){var a=this.getOriginPoint(),b=this.getData(),c=a.x,d=a.y,e=this.getSeries(),f=this.getBarWidth(b,e),g=c,h=d+15,i=c,j=e.length*f/2,k=this.getYAxisLength(),l=k/this.getMaxScale(),m=this.getXFields()[0];this._dataArea=[];for(var n=0;n<b.length;n++){var o=b[n][m],p=this.calculateLabelWidth(o)>f?f:this.calculateLabelWidth(o);i+=f,g=i+j-p/2,this.drawLabel(g,h,o,"middle"),this._dataArea.push(i);for(var q=0;q<e.length;q++){var r=e[q].yField,s=b[n][r],t=s*l,u=e[q].fillColor,v=e[q].strokeColor,w=d-s*l;this.animated?this.animateBarDrawing(i,w,f,t,u,v):this.drawRect(i,w,f,t,u,v),i+=f}}if(this.showTooltip){var x=this,y=e.length,z=this.canvas.getBoundingClientRect(),A=this.getTooltip(),B=A.getContext("2d"),C=this.getTooltipDefaultHeight()+(e.length-1)*(this.getTooltipDefaultLineHeight()+2),D=this.getMaxLabelWidth(this.getMax(),e,this.getTooltipFont());this.canvas.onmousemove=function(c){for(var d=c.clientX-z.left,g=c.clientY-z.top,h=!1,i=0;i<x._dataArea.length;i++)x.mouseIn(d,g,x._dataArea[i],a.y-k,y*f,k)&&(A.height=C,A.width=D+x.getDefaultPadding(),A.style.left=d-A.width/2+"px",A.style.top=g-C+"px",x.customizeTooltip(B,b[i],e,A.width,A.height),h=!0);h||x.hideTooltip()}}},c.animateBarDrawing=function(b,c,d,e,f,g){function h(a,b,c,d,e,f,g,h){setTimeout(function(){a.clearRect(b,c,d,e),a.drawRect(b,c,d,e,f,g)},h)}for(var i,j=360,k=36,l=a.Utils.floor(j/k),m=0;l>m;m++)i=m/l*e,h(this,b,c+e-i,d,i,f,g,m*k);h(this,b,c,d,e,f,g,m*k)},c.getBarWidth=function(b,c){return a.Utils.calculateXAxisItemWidth(b.length,c.length,this.getXAxisLength()-this.getPaddingRight())},a.BarChart=b}(window.zChart),function(a){var b=5,c=20,d=function(b,c){a.AxesChart.call(this,b,c)},e=d.prototype=Object.create(a.AxesChart.prototype);e.drawDataArea=function(){var a=this.getOriginPoint(),d=this.getData(),e=a.x,f=a.y,g=this.getSeries(),h=this.getLineInterval(d,g),i=e,j=f+15,k=this.getYAxisLength(),l=k/this.getMaxScale(),m=this.getXFields()[0];this._dataPoints=[];for(var n=0;n<g.length;n++){var o=g[n].yField,p=g[n].fillColor,q=g[n].strokeColor,r=e,s=!0;this._dataPoints[n]=[];for(var t=0;t<d.length;t++){var u=d[t][m],v=this.calculateLabelWidth(u)>h?h:this.calculateLabelWidth(u),w=d[t][o],x=f-w*l;if(i=r-v/2,s&&this.drawLabel(i,j,u,"middle"),t>0){var y=this._dataPoints[n][t-1];this.animated?this.drawLinesAfterTime(y,{x:r,y:x},2,q,1e3*t/c):this.drawLines(y.x,y.y,[{x:r,y:x}],2,q)}this.animated?this.drawCircleAfterTime(r,x,b,p,q,1e3*t/c):this.drawCircle(r,x,b,p,q),this._dataPoints[n].push({x:r,y:x}),r+=h}s=!1}if(this.showTooltip){var z=this,A=this.canvas.getBoundingClientRect(),B=this.getTooltip(),C=B.getContext("2d"),D=this.getTooltipDefaultHeight()+2,E=this.getMaxLabelWidth(this.getMax(),g,this.getTooltipFont());this.canvas.onmousemove=function(a){for(var c=a.clientX-A.left,e=a.clientY-A.top,f=!1,h=0;h<z._dataPoints.length;h++)for(var i=0;i<z._dataPoints[h].length;i++){var j=z._dataPoints[h][i];z.mouseInCircle(c,e,j.x,j.y,b)&&(B.height=D,B.width=E+z.getDefaultPadding(),B.style.left=c-B.width/2+"px",B.style.top=e-D+"px",z.customizeTooltip(C,d[i],[g[h]],B.width,B.height),f=!0)}f||z.hideTooltip()}}},e.mouseInCircle=function(b,c,d,e,f){return a.Utils.mouseInCircle(b,c,d,e,f)},e.drawLinesAfterTime=function(a,b,c,d,e){var f=this;setTimeout(function(){f.drawLines(a.x,a.y,[b],2,d)},e)},e.drawCircleAfterTime=function(a,b,c,d,e,f){var g=this;setTimeout(function(){g.drawCircle(a,b,c,d,e)},f)},e.clearCircle=function(a,b,c){var d=this.context;d.beginPath(),d.arc(a,b,c,0,2*Math.PI,!1),d.clip(),d.clearRect(a-c-1,b-c-1,2*c+2,2*c+2)},e.drawCircle=function(a,b,c,d,e){var f=this.context;f.beginPath(),f.arc(a,b,c,0,2*Math.PI,!1),f.fillStyle=d,d&&f.fill(),f.lineWidth=1,f.strokeStyle=e,f.stroke()},e.getLineInterval=function(b){return a.Utils.calculateXAxisItemWidth(b.length-1,0,this.getXAxisLength()-this.getPaddingRight())},a.LineChart=d}(window.zChart);