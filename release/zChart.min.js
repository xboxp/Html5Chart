window.zChart=window.zChart||{},function(a){var b=.618,c={calculateFontSize:function(a){if(a&&""!==a)for(var b=a.split(" "),c=0;c<b.length;c++)if(b[c].indexOf("px")>0)return parseInt(b[c].substr(0,b[c].length-2));return 0},findMax:function(a,b,c){var d=this.getFields(b,"yField");return this.findMaxInAll(a,d,c)},findMaxInAll:function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(this.max(a,b[e],c));return this.max(d,void 0,c)},max:function(a,b,c){var d=null;if(a&&a.length>0){d=void 0===b?a[0]:a[0][b];for(var e=1;e<a.length;e++){var f=void 0===b?a[e]:a[e][b];void 0!==c&&c===!0?d>f&&(d=f):f>d&&(d=f)}}return d},getFields:function(a,b){var c=[];if(a&&a.length>0)for(var d=0;d<a.length;d++)c.push(a[d][b]);return c},getScale:function(a){var b=this.floor(a);return b>0?b.toString().length:0},getScales:function(a){var c,d=[0],e=10,f=this.getScale(a);if(1>=f){c=a>5?1:.5;for(var g=1;e>=g;g++)d.push(c*g)}else if(a>Math.pow(10,f)*b){c=Math.pow(10,f-1);for(var h=1;e>=h;h++)d.push(c*h)}else{c=Math.pow(10,f-1)/2;for(var i=a/c,j=1;i+2>=j;j++)d.push(c*j)}return d},calculateXAxisItemWidth:function(a,b,c){var d=0,e=300,f=c/a/(b+1);return d=f>1?e>f?this.floor(f):e:1},floor:function(a){var b=a.toString().split(".");return parseInt(b[0])},mouseIn:function(a,b,c,d,e,f){return a>c&&c+e>a&&b>d&&d+f>b?!0:!1}};a.Utils=c}(window.zChart),window.zChart=window.zChart||{},function(a){var b=5,c=13,d=100,e=6*b,f="14px Segoe UI Light",g="4px Arial",h=30,i=10,j=function(a,b){this.canvas=a,this.context=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this._parameters=b},k=j.prototype;k.initialize=function(){var a=["dataProvider","series"],c={animated:!0,showTooltip:!0,showLegend:!0,showGrid:!0,title:{label:"",color:"#000",font:f,top:b}};if(void 0===this._parameters||null===this._parameters)return console.error("Error: miss param "),!1;for(var g=0;g<a.length;g++)if(!this._parameters.hasOwnProperty(a[g]))return console.error("Error: miss param "+a[g]),!1;for(var h in c)if(this[h]=void 0===this._parameters[h]?c[h]:this._parameters[h],"title"==h)for(var i in c.title)this.title[i]=void 0===this.title[i]?c.title[i]:this.title[i];return this.width<d||this.height<e?(console.error("Canvas is too small for zChart(minWidth:"+d+", minHeight:"+e),!1):(this._headerHeight=0,this._footerHeight=2*b,this._paddingRight=2*b,!0)},k.drawChart=function(){this.initialize()&&(this.drawTitle(),this.drawLegend(),this.createTooltip(),this.draw())},k.drawTitle=function(){if(""!==this.title.label){var c=this.title.top;this.drawLabel(this.width/2,c,this.title.label,"center",this.title.font),this._headerHeight=c+a.Utils.calculateFontSize(this.context.font)/2+b}},k.drawLegend=function(){var a=0,c=b,d=this.height-i-b,e=this.getSeries();if(this.showLegend){this.setFooterHeight(i+2*b);for(var f=0;f<e.length;f++){var g=e[f],j=g.label?g.label:g.yField;c+=a,a=h+2*b+this.calculateLabelWidth(j),this.drawRect(c,d,h,i,g.fillColor,g.strokeColor),this.drawLabel(c+h+b,d+i,j,"left")}}},k.draw=function(){console.error("BaseChart should not be initialized directly. Use sub classes(BarChart, LineChart etc) instead.")},k.createTooltip=function(){this._tipCanvas=document.createElement("canvas"),this._tipCanvas.width=100,this._tipCanvas.height=c,this._tipCanvas.style.position="absolute",this.canvas.nextSibling?this.canvas.parentNode.insertBefore(this._tipCanvas,this.canvas.nextSibling):this.canvas.parentNode.appendChild(this._tipCanvas)},k.getTooltip=function(){return this._tipCanvas},k.hideTooltip=function(){this._tipCanvas.style.left="-"+(this._tipCanvas.width+100)+"px"},k.getParam=function(){return this._parameters},k.getData=function(){return this._parameters.dataProvider},k.getSeries=function(){return this._parameters.series},k.getDefaultPadding=function(){return b},k.getPaddingRight=function(){return this._paddingRight},k.setHeaderHeight=function(a){this._headerHeight=a},k.getHeaderHeight=function(){return this._headerHeight},k.setFooterHeight=function(a){this._footerHeight=a},k.getFooterHeight=function(){return this._footerHeight},k.getTooltipDefaultHeight=function(){return c},k.calculateLabelWidth=function(a,b){return this.context.font=void 0===b?g:b,this.context.measureText(a).width},k.drawLabel=function(a,b,c,d,e){this.context.font=void 0===e?g:e,this.context.textAlign=d,this.context.fillStyle="black",this.context.fillText(c,a,b)},k.drawRect=function(a,b,c,d,e,f){this.context.beginPath(),this.context.rect(a,b,c,d),this.context.fillStyle=e?e:"#0099ff",this.context.fill(),this.context.lineWidth=1,this.context.strokeStyle=f,this.context.stroke()},k.drawLines=function(a,b,c,d,e){this.context.strokeStyle=e,this.context.lineWidth=d,this.context.beginPath(),this.context.moveTo(a,b);for(var f=0;f<c.length;f++)this.context.lineTo(c[f].x,c[f].y);this.context.stroke()},a.BaseChart=j}(window.zChart),function(a){var b=6,c="gray",d=function(b,c){a.BaseChart.call(this,b,c),this._labelWidth=40,this._labelHeight=20},e=d.prototype=Object.create(a.BaseChart.prototype);e.draw=function(){this.drawAxes(),this.drawDataArea()},e.drawAxes=function(){this._origin={x:this.getDefaultPadding()+this._labelWidth,y:this.height-this.getFooterHeight()-this._labelHeight},this.setXAxisLength(this.width-this.getPaddingRight()-this._origin.x),this.setYAxisLength(this._origin.y-this.getHeaderHeight());var a=this.getDefaultPadding(),d=this._origin.x,e=this.getHeaderHeight(),f=this.getScales(),g=this.getXAxisLength(),h=this.getYAxisLength(),i=d+g,j=[];j.push({x:d,y:this._origin.y}),j.push({x:i,y:this._origin.y}),this.showGrid&&(j.push({x:i,y:e}),j.push({x:d,y:e})),this.drawLines(d,e,j,"1",c);var k=this.getYAxisLabelFunc();if(f.length>1)for(var l=h/(f.length-1),m=0;m<f.length;m++){var n=this._origin.y-l*m,o=void 0===k?f[m]:k.call(null,f[m]),p=m%2===0?"2":"1",q=[],r=this.calculateLabelWidth(o);q.push({x:this._origin.x-b,y:n}),this.drawLines(this._origin.x,n,q,p,"#e5e5e5"),this.drawLabel(a+(this._labelWidth-(r+b)),n+4,o,"left")}},e.clearRect=function(a,b,c,d){this.context.clearRect(a,b,c,d)},e.drawDataArea=function(){console.error("AxesChart should not be initialized directly. Use sub classes(BarChart, LineChart etc) instead.")},e.getOriginPoint=function(){return this._origin},e.setXAxisLength=function(a){this.xAxisLength=a},e.getXAxisLength=function(){return this.xAxisLength},e.setYAxisLength=function(a){this.yAxisLength=a},e.getYAxisLength=function(){return this.yAxisLength},e.getMax=function(){return a.Utils.findMax(this.getData(),this.getSeries())},e.getScales=function(){return a.Utils.getScales(this.getMax())},e.getMaxScale=function(){var a=1,b=this.getScales();return b.length>0&&(a=b[b.length-1]),a},e.getXFields=function(){return a.Utils.getFields(this.getSeries(),"xField")},e.getYFields=function(){return a.Utils.getFields(this.getSeries(),"yField")},e.getYAxisLabelFunc=function(){var a=this.getParam();return void 0===a.yAxis?void 0:a.yAxis.labelFunction},a.AxesChart=d}(window.zChart),function(a){var b="10px Arial",c=function(b,c){a.AxesChart.call(this,b,c),this._dataArea=[]},d=c.prototype=Object.create(a.AxesChart.prototype);d.drawDataArea=function(){for(var a=this.getOriginPoint(),c=this.getData(),d=a.x,e=a.y,f=this.getSeries(),g=this.getBarWidth(c,f),h=d,i=e+15,j=d,k=f.length*g/2,l=this.getXAxisLength(),m=this.getYAxisLength(),n=m/this.getMaxScale(),o=this.getXFields()[0],p=0;p<c.length;p++){var q=c[p][o];j+=g,h=j+k-this.calculateLabelWidth(q)/2,this.drawLabel(h,i,q,"middle"),this._dataArea.push(j);for(var r=0;r<f.length;r++){var s=f[r].yField,t=c[p][s],u=t*n,v=f[r].fillColor,w=f[r].strokeColor,x=e-t*n;this.animated?this.animateBarDrawing(j,x,g,u,v,w):this.drawRect(j,x,g,u,v,w),j+=g}}if(this.showTooltip){var y=this,z=f.length,A=this.canvas.getBoundingClientRect(),B=this.getTooltip(),C=B.getContext("2d"),D=f.length*(this.getTooltipDefaultHeight()+2),E=this.getMaxLabelWidth(this.getMax(),f,b);this.canvas.onmousemove=function(b){var d=b.clientX-A.left,e=b.clientY-A.top,h=!1;if(y.mouseIn(d,e,a.x,a.y-m,l,m))for(var i=0;i<y._dataArea.length;i++)y.mouseIn(d,e,y._dataArea[i],a.y-m,z*g,m)&&(B.height=D,B.width=E+y.getDefaultPadding(),B.style.left=d+"px",B.style.top=e-D+"px",y.customizeTooltip(C,c[i],f,B.width,B.height),h=!0);h||y.hideTooltip()}}},d.customizeTooltip=function(a,c,d,e,f){a.clearRect(0,0,e,f),a.beginPath(),a.rect(0,0,e,f),a.fillStyle="white",a.fill(),a.lineWidth=1,a.strokeStyle="gray",a.stroke(),a.font=b,a.fillStyle="black",a.textAlign="left";for(var g=0;g<d.length;g++){var h=d[g].yField,i=void 0===d[g].label?h:d[g].label;a.fillText(this.tooltipLabelFunc(i,c[h],this.getYAxisLabelFunc()),2,this.getTooltipDefaultHeight()*(g+1))}},d.mouseIn=function(b,c,d,e,f,g){return a.Utils.mouseIn(b,c,d,e,f,g)},d.animateBarDrawing=function(b,c,d,e,f,g){function h(a,b,c,d,e,f,g,h){setTimeout(function(){a.clearRect(b,c,d,e),a.drawRect(b,c,d,e,f,g)},h)}for(var i,j=360,k=36,l=a.Utils.floor(j/k),m=0;l>m;m++)i=m/l*e,h(this,b,c+e-i,d,i,f,g,m*k);h(this,b,c,d,e,f,g,m*k)},d.getBarWidth=function(b,c){return a.Utils.calculateXAxisItemWidth(b.length,c.length,this.getXAxisLength()-this.getPaddingRight())},d.getMaxLabelWidth=function(c,d){for(var e=[],f=0;f<d.length;f++)e.push({width:this.calculateLabelWidth(this.tooltipLabelFunc(d[f].label,c,this.getYAxisLabelFunc()),b)});return a.Utils.max(e,"width")},d.tooltipLabelFunc=function(a,b,c){return c&&(b=c.call(null,b)),a+":"+b},a.BarChart=c}(window.zChart);