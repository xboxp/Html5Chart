window.iChart=window.iChart||{},function(a){var b=.618,c={calculateFontSize:function(a){if(a&&""!=a)for(var b=a.split(" "),c=0;c<b.length;c++)if(b[c].indexOf("px")>0)return parseInt(b[c].substr(0,b[c].length-2));return 0},findMax:function(a,b,c){var d=this.getFields(b,"yField");return this.findMaxInAll(a,d,c)},findMaxInAll:function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(this.max(a,b[e],c));return this.max(d,void 0,c)},max:function(a,b,c){var d=null;if(a&&a.length>0){d=void 0==b?a[0]:a[0][b];for(var e=1;e<a.length;e++){var f=void 0==b?a[e]:a[e][b];void 0!=c&&1==c?d>f&&(d=f):f>d&&(d=f)}}return d},getFields:function(a,b){var c=[];if(a&&a.length>0)for(var d=0;d<a.length;d++)c.push(a[d][b]);return c},getScale:function(a){var b=this.floor(a);return b>0?b.toString().length:0},getScales:function(a){var c,d=[0],e=10,f=this.getScale(a);if(1>=f){c=a>5?1:.5;for(var g=1;e>=g;g++)d.push(c*g)}else if(a>Math.pow(10,f)*b){c=Math.pow(10,f-1);for(var g=1;e>=g;g++)d.push(c*g)}else{c=Math.pow(10,f-1)/2;for(var h=a/c,g=1;h+2>=g;g++)d.push(c*g)}return d},calculateXAxisItemWidth:function(a,b,c){var d=0,e=300,f=c/a/(b+1);return d=f>1?e>f?this.floor(f):e:1},floor:function(a){var b=a.toString().split(".");return parseInt(b[0])}};a.Utils=c}(window.iChart),window.iChart=window.iChart||{},function(a){var b=5,c=100,d=6*b,e=function(a,b){this.canvas=a,this.context=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this._parameters=b},f=e.prototype;f.initialize=function(){var a=["dataProvider","series"],e={animated:!0,showTooltip:!0,showLegend:!0,showGrid:!0,title:{label:"",color:"#000",font:"14px Segoe UI Light",top:b}};if(void 0==this._parameters||null==this._parameters)return console.error("Error: miss param "),!1;for(var f=0;f<a.length;f++)if(!this._parameters.hasOwnProperty(a[f]))return console.error("Error: miss param "+a[f]),!1;for(var g in e)if(this[g]=void 0==this._parameters[g]?e[g]:this._parameters[g],"title"==g)for(var h in e.title)this.title[h]=void 0==this.title[h]?e.title[h]:this.title[h];return this.width<c||this.height<d?(console.error("Canvas is too small for iChart(minWidth:"+c+", minHeight:"+d),!1):(this._headerHeight=0,this._footerHeight=2*b,this._paddingRight=2*b,!0)},f.drawChart=function(){this.initialize()&&(this.drawTitle(),this.drawLegend(),this.draw(),this.createTooltip())},f.drawTitle=function(){if(""!=this.title.label){var c=this.title.top;this.drawLabel(this.width/2,c,this.title.label,"center"),this._headerHeight=c+a.Utils.calculateFontSize(this.context.font)/2+b}},f.drawLegend=function(){if(this.showLegend)for(var a=0;a<this._parameters.series;a++){this._parameters.series[a]}},f.draw=function(){console.error("BaseChart should not be initialized directly. Use sub classes(BarChart, LineChart etc) instead.")},f.createTooltip=function(){},f.getParam=function(){return this._parameters},f.getData=function(){return this._parameters.dataProvider},f.getSeries=function(){return this._parameters.series},f.getDefaultPadding=function(){return b},f.getPaddingRight=function(){return this._paddingRight},f.setHeaderHeight=function(a){this._headerHeight=a},f.getHeaderHeight=function(){return this._headerHeight},f.setFooterHeight=function(a){this._footerHeight=a},f.getFooterHeight=function(){return this._footerHeight},f.drawLabel=function(a,b,c,d,e){this.context.font=void 0==e?"4px Arial":e,this.context.textAlign=d,this.context.fillStyle="black",this.context.fillText(c,a,b)},f.drawRect=function(a,b,c,d,e,f){this.context.beginPath(),this.context.rect(a,b,c,d),this.context.fillStyle=e,this.context.fill(),this.context.lineWidth=1,this.context.strokeStyle=f,this.context.stroke()},f.drawLines=function(a,b,c,d,e){this.context.strokeStyle=e,this.context.lineWidth=d,this.context.beginPath(),this.context.moveTo(a,b);for(var f=0;f<c.length;f++)this.context.lineTo(c[f].x,c[f].y);this.context.stroke()},f.calculateLabelWidth=function(a,b){return this.context.font=void 0==b?"4px Arial":b,this.context.measureText(a)},a.BaseChart=e}(window.iChart),function(a){var b=6,c="gray",d=function(b,c){a.BaseChart.call(this,b,c),this._labelWidth=40,this._labelHeight=20},e=d.prototype=Object.create(a.BaseChart.prototype);d.prototype.parent=a.BaseChart.prototype,e.draw=function(){this.drawAxes(),this.drawDataArea()},e.drawAxes=function(){this._origin={x:this.getDefaultPadding()+this._labelWidth,y:this.height-this.getFooterHeight()-this._labelHeight},this.setXAxisLength(this.width-this.getPaddingRight()-this._origin.x),this.setYAxisLength(this._origin.y-this.getHeaderHeight());var a=this.getDefaultPadding();x=this._origin.x,y=this.getHeaderHeight(),scales=this.getScales(),xAxisLength=this.getXAxisLength(),yAxisLength=this.getYAxisLength(),xAxisEndX=x+xAxisLength;var d=[];d.push({x:x,y:this._origin.y}),d.push({x:xAxisEndX,y:this._origin.y}),this.showGrid&&(d.push({x:xAxisEndX,y:y}),d.push({x:x,y:y})),this.drawLines(x,y,d,"1",c);var e=this.getYAxisLabelFunc();if(scales.length>1)for(var f=yAxisLength/(scales.length-1),g=0;g<scales.length;g++){var h=this._origin.y-f*g,i=void 0==e?scales[g]:e.call(null,scales[g]),j=g%2==0?"2":"1",k=[],l=this.calculateLabelWidth(i);console.log("label width is "+l),k.push({x:this._origin.x-b,y:h}),this.drawLines(this._origin.x,h,k,j,"#e5e5e5"),this.drawLabel(a+l/2,h+4,i,"left")}},e.clearRect=function(a,b,c,d){this.context.clearRect(a,b,c,d)},e.drawDataArea=function(){console.error("AxesChart should not be initialized directly. Use sub classes(BarChart, LineChart etc) instead.")},e.getOriginPoint=function(){return this._origin},e.setXAxisLength=function(a){this.xAxisLength=a},e.getXAxisLength=function(){return this.xAxisLength},e.setYAxisLength=function(a){this.yAxisLength=a},e.getYAxisLength=function(){return this.yAxisLength},e.getMax=function(){return a.Utils.findMax(this.getData(),this.getSeries())},e.getScales=function(){return a.Utils.getScales(this.getMax())},e.getMaxScale=function(){var a=1,b=this.getScales();return b.length>0&&(a=b[b.length-1]),a},e.getXFields=function(){return a.Utils.getFields(this.getSeries(),"xField")},e.getYFields=function(){return a.Utils.getFields(this.getSeries(),"yField")},e.getYAxisLabelFunc=function(){var a=this.getParam();return void 0==a.yAxis?void 0:a.yAxis.labelFunction},a.AxesChart=d}(window.iChart),function(a){var b=function(b,c){a.AxesChart.call(this,b,c)},c=b.prototype=Object.create(a.AxesChart.prototype);b.prototype.parent=a.AxesChart.prototype,c.drawDataArea=function(){for(var b=this.getOriginPoint(),c=this.getData(),d=b.x,e=b.y,f=this.getSeries(),g=a.Utils.calculateXAxisItemWidth(c.length,f.length,this.getXAxisLength()-this.getPaddingRight()),h=d,i=e+15,j=d,k=f.length*g/2,l=this.getYAxisLength(),m=l/this.getMaxScale(),n=this.getXFields()[0],o=0;o<c.length;o++){j+=g,h=j+k-5,this.drawLabel(h,i,c[o][n],"middle");for(var p=0;p<f.length;p++){var q=f[p].yField,r=c[o][q],s=r*m,t=f[p].fillColor,u=f[p].strokeColor,v=e-r*m;this.animated?this.animateBarDrawing(j,v,g,s,t,u):this.drawRect(j,v,g,s,t,u),j+=g}}},c.animateBarDrawing=function(b,c,d,e,f,g){function h(a,b,c,d,e,f,g,h){setTimeout(function(){a.clearRect(b,c,d,e),a.drawRect(b,c,d,e,f,g)},h)}for(var i,j=360,k=36,l=a.Utils.floor(j/k),m=0;l>m;m++)i=m/l*e,h(this,b,c+e-i,d,i,f,g,m*k);h(this,b,c,d,e,f,g,m*k)},a.BarChart=b}(window.iChart);